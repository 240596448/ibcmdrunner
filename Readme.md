
# ibcmdrunner

## Библиотека для упрощения работы с утилитами ibcmd и ibsrv из oscript.

Позволяет выполнять операции с информационной базой в стиле [v8runner](https://github.com/oscript-library/v8runner).

Пример работы:

```bsl

УправлениеИБ = Новый УправлениеИБ;
ВременныйКаталог = ОбъединитьПути(КаталогВременныхФайлов(), "tmp_db");
УправлениеИБ.УстановитьПараметрыФайловойИБ(ВременныйКаталог);
ПутьКФайлуКонфигурации = "c:\tmp\1c.cf";
УправлениеИБ.СоздатьИБИзФайлаКонфигурации(ПутьКФайлуКонфигурации);
```

## Публичный интерфейс

### Класс УправлениеИБ:

#### Путь к приложению

```bsl
// Устанавливает и возвращает путь к файлу приложения
// Параметры:
//  Путь - Строка - путь к файлу приложения
// Возвращаемое значение:
//   Строка - текущий путь к приложению
```

#### УстановитьПараметрыСервернойИБ

```bsl
// Установить параметры запуска для клиент-серверной информационной базы
// Параметры:
//  ТипСУБД - Строка - Тип СУБД. Допускаются значения
//          MSSQLServer - Microsoft SQL Server;
//        	PostgreSQL - PostgreSQL;
//        	IBMDB2 - IBM DB2;
//        	OracleDatabase - Oracle Database.
//        
//  СерверСУБД - строка - Имя сервера СУБД;
//  ИмяБД - Строка - Имя базы данных в СУБД;
//  ПользовательБД - Строка - Имя пользователя СУБД;
//  ПарольБД - Строка - Пароль пользователя в БД;
```

#### УстановитьПараметрыФайловойИБ

```bsl
// Установить параметры файловой информационной базы.
// Все команды ibcmd будут учитывать этот параметр.
//
// Параметры:
//   ПутьРабочийКаталог - Строка - Путь к рабочему каталогу.
```

#### УстановитьКонфигурационныйФайл

```bsl
// Установить конфигурационный файл автономного сервера 
// Параметры:
//  ИмяФайла - Строка - Полный путь к файлу конфигурации автономного сервера (yml);
```

#### УстановитьПараметрыАвторизацииИБ

```bsl
// Установить параметры авторизации информационной базы
// Параметры:
//  ПользовательИБ - Строка - имя пользователя информационной базы
//  ПарольИБ - Строка - пароль пользователя информационной базы
```

#### СоздатьИБИзФайлаВыгрузки

```bsl
// Создать информационную базу из файла выгрузки.
// Для команды автоматом устанавливаются параметры "--create-database" и "--force"
// Параметр "--apply" не устанавливается, предполагается использование отдельной команды
// Параметры:
//  ПутьКФайлувыгрузки - Строка - Путь к файлу выгрузки информационной базы
//  Локаль - Строка - имя локали 
//  СмещениеДат - Число - Смещение дат в годах (имеет смысл только для MSSQL)
```

#### СоздатьИБИзФайлаКонфигурации

```bsl
// Создать информационную базу из файла конфигурации.
// Для команды автоматом устанавливаются параметры "--create-database" и "--force"
// Параметр "--apply" не устанавливается, предполагается использование отдельной команды
// Параметры:
//  ПутьКФайлуКонфигурации - Строка - Путь к файлу конфигурации информационной базы
//  Локаль - Строка - имя локали 
//  СмещениеДат - Число - Смещение дат в годах (имеет смысл только для MSSQL)
```

#### СоздатьИБИзФайловКонфигурации

```bsl
// Создать информационную базу из файлов конфигурации.
// Для команды автоматом устанавливаются параметры "--create-database" и "--force"
// Параметр "--apply" не устанавливается, предполагается использование отдельной команды
// Параметры:
//  ПутьККаталогуВыгрузки - Строка - Путь к каталогу выгрузки конфигурации в файлы
//  Локаль - Строка - имя локали 
//  СмещениеДат - Число - Смещение дат в годах (имеет смысл только для MSSQL)
```

#### ВыгрузитьДанныеИБ

```bsl
// Выгрузить данные из информационной базы
// Параметры:
//  ПутьКФайлуВыгрузки - Строка - Путь к файлу выгрузки
```

#### ЗагрузитьДанныеИБ

```bsl
// Загрузить данные из файла выгрузки
// Автоматом добавляется параметр "--create-database"
// Параметры:
//  ПутьКФайлуВыгрузки - Строка - Путь к файлу выгрузки
```

#### ЗагрузитьКонфигурацию

```bsl
// Загрузить конфигурацию из файла
// Параметры:
//  ПутьКФайлуКонфигурации - Строка - Путь к файлу конфигурации
//  ИмяРасширения -Строка - Имя расширения. Если не заполнено, то будет загружена
//      основная конфигурация
```

#### ВыгрузитьКонфигурациюВФайл

```bsl
// Выгрузить конфигурацию базы данных в файл
// Параметры:
//  ПутьКФайлуКонфигурации - Строка - Путь к файлу конфигурации
//  ИмяРасширения - Строка - Имя расширения. Если не заполнено, то будет выгружена
//      конфигурация БД или основная конфигурация (см. следующий параметр)
//  ВыгружатьОсновнуюКонфигурацию - Булево - Если Истина, то будет выгружена основная
//      конфигурация
```

#### ПроверитьКонфигурацию

```bsl
// Проверить конфигурацию
// Параметры:
//  ИмяРасширения - Строка - имя расширения
// Возвращаемое значение:
//  - Строка - строка консольного вывода команды
```

#### ОбновитьКонфигурациюБазыДанных

```bsl
// Обновить конфигурацию
// Параметры:
//  ИмяРасширения - Строка - имя расширения
```

#### ВозвратитьсяККонфигурацииБазыДанных

```bsl
// Возвратиться к конфигурации базы данных
// Параметры:
//  ИмяРасширения - Строка - имя расширения
```

#### ВыгрузитьВФайлСостояниеКонфигурации

```bsl
// Вывести информацию о состоянии конфигурации (ConfigDumpInfo)
// Параметры:
//  ПутьКФайлуXML - Строка - Путь к файлу состояния конфигурации (ConfigDumpInfo)
//  ИмяРасширения - Строка - Имя расширения
```

#### ВыгрузитьВФайлИзмененияКонфигурации

```bsl
// Вывести информацию о изменениях конфигурации относительно переданного состояния (ConfigDumpInfo)
// Параметры:
//  ПутьКФайлуXMLИзменений - Строка - Путь к файлу для записи информации о изменениях в конфигурации
//  ПутьКФайлуXMLВыгрузки - Строка - Путь к файлу информации о конфигурации
//                           (ConfigDumpInfo) относительно которого вычисляются изменения текущей конфигурации
//  ИмяРасширения - Строка - Имя расширения
//  ВыводитьВКраткомФормате - Булево - Отображать информацию о изменениях в сокращенном виде
```

#### ВыгрузитьОбъектыКонфигурацииВФайлы

```bsl
// Экспорт выбранных объектов конфигурации в XML
// Параметры:
//  КаталогВыгрузки - Строка - Каталог для экспорта 
//  ВыгружатьРекурсивно - Булево - Выполнять экспорт дочерних объектов.
//  Объекты - Массив - Список строк - имен объектов конфигурации для экспорта.
//  ИмяРасширения - Строка - Имя расширения
```

#### ВыгрузитьВсеРасширенияВФайлы

```bsl
// Выгрузить все расширения в файлы
// Параметры:
//  КаталогВыгрузки - Строка - Каталог выгрузки расширений в файлы
```

#### ВыгрузитьКонфигурациюВФайлы

```bsl
// Экспорт конфигурации в файлы
// Параметры:
//  КаталогВыгрузки -Строка - Каталог для выгрузки конфигурации в файлы
//  ПутьКФайлуXMLВыгрузки - Строка - Путь к файлу информации о конфигурации
//        (ConfigDumpInfo) относительно которого вычисляются изменения текущей конфигурации
//  ИмяРасширения - Строка - Имя расширения
//  Синхронизировать - Булево - Синхронизировать имеющийся экспорт с конфигурацией
```

#### ЗагрузитьКонфигурациюИзФайлов

```bsl
// Загружает основную конфигурацию или расширение из файлов
// Параметры:
//  КаталогВыгрузки - Строка - Имя корневого каталога с ранее выгруженными файлами
//  ИмяРасширения - Строка - Имя расширения конфигурации. Если не заполнено, то загружать
//                           в основную конфигурацию
```

#### ЗагрузитьВыбранныеФайлыКонфигурации

```bsl
// Импорт выбранных файлов конфигурации из XML
// Параметры:
//  КаталогВыгрузки - Строка - каталог выгрузки файлов
//  ВыбранныеФайлы - Массив - список файлов для загрузки
//  ИмяРасширения - Строка - имя расширения
```

#### ЗагрузитьВсеРасширенияИзФайлов

```bsl
// Импорт всех расширений конфигурации из XML
// Параметры:
//  КаталогВыгрузки - строка - Каталог выгрузки расширений в файлы
```

#### Версия

```bsl
// Получить версию платформы 1С
// Возвращаемое значение:
//  Строка - Версия платформы 1С
```
